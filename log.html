<!DOCTYPE html>
<html lang="pt-br">
<head>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sistema de Coletas</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="css/styles.css"/>
</head>
<body>
<!--
    Retirada a classe `navbar-expand-lg` para que o menu seja sempre
    colapsado e exibido apenas ao acionar o botão hamburguer.
  -->
  <nav class="navbar navbar-dark bg-dark mb-4">
  <div class="container-fluid">
    <span class="navbar-brand d-flex align-items-center">
      <img src="logo.png" alt="Logo" height="40" class="me-2" />
      Coletas KOERICH
    </span>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarLinks" aria-controls="navbarLinks" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarLinks">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0" id="menu-links"></ul>
      <span class="navbar-text text-white me-3" id="user-info"></span>
    </div>
  </div>
 </nav>

 <div class="container">
  <h2>Log de Alterações</h2>
  <table class="table table-bordered table-hover mt-4">
    <thead class="table-light">
      <tr>
        <th>Data/Hora</th>
        <th>Usuário</th>
        <th>Ação</th>
        <th>IP</th>
      </tr>
    </thead>
    <tbody id="tabelaLogs"></tbody>
  </table>
 </div>

 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
 <script src="js/menu.js"></script>
 <script>
  const currentUser = JSON.parse(localStorage.getItem("usuarioLogado"));
  // Somente admin pode acessar esta página
  if (!currentUser || currentUser.tipo !== "admin") {
    Swal.fire("Acesso não autorizado!");
    window.location.href = "index.html";
  }
  const tabelaLogs = document.getElementById("tabelaLogs");
  const logs = JSON.parse(localStorage.getItem("logs") || "[]");
  logs.forEach(log => {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${log.dataHora}</td>
      <td>${log.usuario}</td>
      <td>${log.acao}</td>
      <td>${log.ip}</td>
    `;
    tabelaLogs.appendChild(row);
  });
 </script>
</body>
</html>